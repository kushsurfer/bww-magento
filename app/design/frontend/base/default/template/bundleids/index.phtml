<?php
 
 	if(!isset($_GET['prodID'])){
 		header("Location: ". Mage::getBaseUrl());
		die();
 	
 	} else {
	 	$prodID = $_GET['prodID'];
		$bundled_product = new Mage_Catalog_Model_Product();		
		$bundled_product->load($prodID);
	 	

	 	
		$opt = Mage::getModel('bundle/option')->getResourceCollection()->setProductIdFilter($prodID)->setPositionOrder()->joinValues($this->getStoreFilter());
	 	$titles = $opt->getItems('default_title');

	 	$optionTitle = array();
	 	$bundled_items = array();

	 	// get option title
	 	foreach ($titles as $key => $value){
	 	 	$val = $value->getData();
	 	 	$optionTitle[$value['option_id']] =  $value['default_title'];
	 	 	$bundled_items[$value['default_title']]['option_id'] = $value['option_id'];
	 	 
	 	}
	 	

	 	$selectionCollection = $bundled_product->getTypeInstance(true)->getSelectionsCollection(
			$bundled_product->getTypeInstance(true)->getOptionsIds($bundled_product), $bundled_product
		);
	 	
		foreach($selectionCollection as $option) 
		{	
			
			$bundled_items[$optionTitle[$option->getOptionId()]]['productIDs'][] = $option->product_id;
			var_dump($option);
			echo '<br/><br/><br/>';
		}
	 
		// print_r($bundled_items);
		// echo '<br/><br/><br/>';
		echo json_encode($bundled_items);
	}
 
?>