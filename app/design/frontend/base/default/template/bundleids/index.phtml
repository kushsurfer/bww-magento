<?php
 
 	if(!isset($_GET['prodID'])){
 		header("Location: ". Mage::getBaseUrl());
		die();
 	
 	} else {
	 	$prodID = $_GET['prodID'];
		$bundled_product = new Mage_Catalog_Model_Product();		
		$bundled_product->load($prodID);
	 	
	 
	 	
		$opt = Mage::getModel('bundle/option')->getResourceCollection()->setProductIdFilter($prodID)->setPositionOrder()->joinValues($this->getStoreFilter());


	 	$titles = $opt->getItems('default_title');

	 	$optionTitle = array();
	 	$bundled_items = array();

	 	// get option title
	 	foreach ($titles as $key => $value){
	 	 	$val = $value->getData();
	 	 	$optionTitle[$value['option_id']] =  $value['default_title'];
	 	 	$bundled_items[$value['default_title']]['option_id'] = $value['option_id'];
	 	 
	 	}
	 	

	 	$selectionCollection = $bundled_product->getTypeInstance(true)->getSelectionsCollection(
			$bundled_product->getTypeInstance(true)->getOptionsIds($bundled_product), $bundled_product
		);

	 	$typeInstance = $bundled_product->getTypeInstance(true);

	 	$optionCollection = $typeInstance->getOptionsCollection($bundled_product);

 		$_options = $optionCollection->appendSelections($selectionCollection, false,
                Mage::helper('catalog/product')->getSkipSaleableCheck()
                );

        $bundle_option = array();

        foreach ($_options as $key => $value) {
        	echo $key;
            foreach ($value['selections'] as $selKey => $selection) {
            	$selection = $selection->getData('selection_id');
                $bundle_option[$selection->option_id][] = $selection['selection_id'];
                echo $selection['selection_id'];exit;
                echo '<br/><br/><br/>';
            }
            
        }

        // var_dump($bundle_option);
		foreach($selectionCollection as $option) 
		{	
			
			$bundled_items[$optionTitle[$option->getOptionId()]]['productIDs'][] = $option->product_id;
			
			
		}
	 
		// print_r($bundled_items);
		// echo '<br/><br/><br/>';
		// echo json_encode($bundled_items);
	}
 
?>